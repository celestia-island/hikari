// Use theme variables with namespace to avoid conflicts
@use '../../../../theme/styles/variables.scss' as vars;
@use '../../../../theme/styles/mixins.scss' as mix;

// ============================================
// Hikari Button Component
// Features: Subtle rounded corners, glow effects, ambient animations
// ============================================

// Base button styles
.hi-button {
  // Layout
  display: inline-flex;
  align-items: center;
  justify-content: center;

  // Spacing
  padding: 0.5rem 1rem;
  margin: 0;

  // Typography
  font-family: vars.$hikari-font-family-sans;
  font-size: vars.$hikari-font-size-sm;
  font-weight: 500;
  line-height: 1.5;
  letter-spacing: 0.01em;

  // Appearance - Subtle rounded corners
  border-radius: vars.$hikari-radius-fui-sm;
  border: 1px solid transparent;

  // Cursor & interaction
  cursor: pointer;
  user-select: none;
  white-space: nowrap;
  outline: none;

  // Transitions - Global transition for all states
  transition: all 0.3s vars.$hikari-ease-smooth;

  // Position for pseudo-elements
  position: relative;
  overflow: hidden;

  // Acrylic background with theme support
  background-color: var(--hi-color-surface);
  backdrop-filter: blur(4px);

  // Shine effect on hover (animated sweep) - DISABLED for JS animation
  // &::before {
  //   content: '';
  //   position: absolute;
  //   top: 0;
  //   left: -100%;
  //   width: 100%;
  //   height: 100%;
  //   background: linear-gradient(
  //     90deg,
  //     transparent,
  //     var(--hi-white-15, rgba(255, 255, 255, 0.15)),
  //     transparent
  //   );
  //   transition: left vars.$hikari-duration-slow vars.$hikari-ease-smooth;
  //   pointer-events: none;
  //   z-index: 1;
  // }

  // &:hover::before {
  //   left: 100%;
  // }

  &:active {
    transform: scale(0.98);
    // transition: transform vars.$hikari-duration-instant ease-out;
  }

  // Disabled state
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  // Loading state
  &.hi-button-loading {
    pointer-events: none;
  }

  // Optional: Enable CSS transitions with this class (for CSS-only mode)
  &.hi-button-css-transitions {
    transition: all vars.$hikari-duration-fast vars.$hikari-ease-smooth;

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        var(--hi-white-15, rgba(255, 255, 255, 0.15)),
        transparent
      );
      transition: left vars.$hikari-duration-slow vars.$hikari-ease-smooth;
      pointer-events: none;
      z-index: 1;
    }

    &:hover::before {
      left: 100%;
    }

    &:active {
      transition: transform vars.$hikari-duration-instant ease-out;
    }
  }
}

// ============================================
// Variant: Primary (Pink glow accent)
// ============================================

.hi-button-primary {
  background: linear-gradient(135deg, var(--hi-button-primary), var(--hi-button-primary-dark));
  color: var(--hi-color-text-on-primary, #ffffff);
  border: 1px solid var(--hi-border-light, rgba(255, 255, 255, 0.2));

  &:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--hi-button-primary-hover-start), var(--hi-button-primary-hover-end));
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-button-primary);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow:
      0 0 4px var(--hi-button-primary),
      inset 0 1px 0 var(--hi-white-10, rgba(255,255,255, 0.1));
    transform: translateY(0) scale(0.98);
  }
}

// ============================================
// Variant: Secondary (Blue accent)
// ============================================

.hi-button-secondary {
  background: linear-gradient(135deg, var(--hi-button-secondary), var(--hi-button-secondary-dark));
  color: var(--hi-color-text-on-secondary, #ffffff);
  border: 1px solid var(--hi-border-light, rgba(255, 255, 255, 0.2));

  &:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--hi-button-secondary-hover-start), var(--hi-button-secondary-hover-end));
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-button-secondary);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow:
      0 0 4px var(--hi-button-secondary),
      inset 0 1px 0 var(--hi-white-10, rgba(255,255,255, 0.1));
    transform: translateY(0) scale(0.98);
  }
}

// ============================================
// Variant: Ghost (Transparent with theme color border)
// ============================================

.hi-button-ghost {
  background-color: transparent;
  color: var(--hi-ghost-text);
  border: 1px solid var(--hi-ghost-border);
  --hi-glow-transparent: true;
  --hi-glow-bg-color: transparent;
  --hi-glow-color: var(--hi-ghost-glow);

  &:hover:not(:disabled) {
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-ghost-border);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow: 0 0 4px var(--hi-glow-color);
    transform: scale(0.98);
  }
}

// ============================================
// Variant: Borderless (No border, minimal styling)
// ============================================

.hi-button-borderless {
  background-color: transparent;
  color: var(--hi-ghost-text);
  border: none;
  --hi-glow-transparent: true;
  --hi-glow-bg-color: transparent;
  --hi-glow-color: var(--hi-ghost-glow);

  &:hover:not(:disabled) {
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-ghost-border);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow: 0 0 4px var(--hi-glow-color);
    transform: scale(0.98);
  }
}

// ============================================
// Variant: Danger (Red glow accent)
// ============================================

.hi-button-danger {
  background: linear-gradient(135deg, var(--hi-button-danger), var(--hi-button-danger-dark));
  color: var(--hi-color-text-on-danger, #ffffff);
  border: 1px solid var(--hi-border-light, rgba(255, 255, 255, 0.2));

  &:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--hi-button-danger-hover-start), var(--hi-button-danger-hover-end));
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-button-danger);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow:
      0 0 4px var(--hi-button-danger),
      inset 0 1px 0 var(--hi-white-10, rgba(255,255,255, 0.1));
    transform: translateY(0) scale(0.98);
  }
}

// ============================================
// Variant: Success (Green glow accent)
// ============================================

.hi-button-success {
  background: linear-gradient(135deg, var(--hi-button-success), var(--hi-button-success-dark));
  color: var(--hi-color-text-on-success, #ffffff);
  border: 1px solid var(--hi-border-light, rgba(255, 255, 255, 0.2));

  &:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--hi-button-success-hover-start), var(--hi-button-success-hover-end));
    box-shadow: var(--hi-glow-color);
  }

  &:focus-visible {
    outline: 2px solid var(--hi-button-success);
    outline-offset: 2px;
  }

  &:active:not(:disabled) {
    box-shadow:
      0 0 4px var(--hi-button-success),
      inset 0 1px 0 var(--hi-white-10, rgba(255,255,255, 0.1));
    transform: translateY(0) scale(0.98);
  }
}

// ============================================
// Size Variants
// ============================================

.hi-button-sm {
  padding: 0.25rem 0.75rem;
  font-size: 0.75rem;
  gap: 0.375rem;
  border-radius: 3px;
}

.hi-button-md {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  gap: 0.5rem;
  border-radius: vars.$hikari-radius-fui-sm;
}

.hi-button-lg {
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  gap: 0.625rem;
  border-radius: vars.$hikari-radius-fui-md;
}

// ============================================
// Block Variant
// ============================================

.hi-button-block {
  display: flex;
  width: 100%;
}

// ============================================
// Loading Spinner
// ============================================

.hi-button-spinner {
  display: inline-block;
  width: 1rem;
  height: 1rem;
  border: 2px solid currentColor;
  border-right-color: transparent;
  border-radius: 50%;
  animation: hi-spin 0.6s linear infinite;
  opacity: 0.9;
}

// ============================================
// Entrance Animation (Optional)
// ============================================

// DISABLED - migrated to JS animation
// .hi-button-animate-in {
//   animation: button-fade-in 300ms vars.$hikari-ease-smooth forwards;
// }
//
// @keyframes button-fade-in {
//   from {
//     opacity: 0;
//     transform: scale(0.95);
//   }
//   to {
//     opacity: 1;
//     transform: scale(1);
//   }
// }

// ============================================
// Ripple Effect (Optional enhancement)
// ============================================

// DISABLED - handled by JS animation library
// .hi-button-ripple {
//   &::after {
//     content: '';
//     position: absolute;
//     top: 50%;
//     left: 50%;
//     width: 0;
//     height: 0;
//     background: var(--hi-white-30, rgba(255,255,255, 0.3));
//     border-radius: 50%;
//     transform: translate(-50%, -50%);
//     transition: width 0.6s ease-out, height 0.6s ease-out;
//   }
//
//   &:active::after {
//     width: 300px;
//     height: 300px;
//   }
// }

// Icons inside buttons inherit button color
button.hi-button-primary .hikari-icon,
button.hi-button-secondary .hikari-icon,
button.hi-button-danger .hikari-icon,
button.hi-button-success .hikari-icon {
  color: var(--hi-color-text-on-primary, currentColor);
}

button.hi-button-secondary .hikari-icon {
  color: var(--hi-color-text-on-secondary, currentColor);
}

button.hi-button-danger .hikari-icon {
  color: var(--hi-color-text-on-danger, currentColor);
}

button.hi-button-success .hikari-icon {
  color: var(--hi-color-text-on-success, currentColor);
}

button.hi-button-ghost .hikari-icon {
  color: var(--hi-ghost-text-color, currentColor);
}

// SVG elements inherit color from parent
button .hikari-icon svg,
button .hikari-icon svg path,
button .hikari-icon svg circle,
button .hikari-icon svg rect,
button .hikari-icon svg ellipse,
button .hikari-icon svg polygon,
button .hikari-icon svg polyline,
button .hikari-icon svg line {
  color: inherit;
}

// Hover state opacity
button.hi-button-primary:hover .hikari-icon,
button.hi-button-secondary:hover .hikari-icon,
button.hi-button-danger:hover .hikari-icon,
button.hi-button-success:hover .hikari-icon,
button.hi-button-ghost:hover .hikari-icon {
  opacity: 0.9;
}

// ============================================
// Icon and Suffix wrappers - Fixed 14px size (NOT for IconButton)
// ============================================

// Only apply to Button components, not IconButton
button.hi-button:not(.hi-icon-button) {
  .hi-button-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    width: vars.$hikari-icon-size-sm;
    height: vars.$hikari-icon-size-sm;

    // Constrain icon wrapper and SVG to 14px
    .hikari-icon {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }

    .hikari-icon svg {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }

    .hi-button-icon svg {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }
  }

  .hi-button-suffix {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    // Constrain Arrow to 14px
    .hi-arrow {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }

    .hi-arrow svg {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }

    // Constrain icon wrapper and SVG to 14px
    .hikari-icon {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }

    .hikari-icon svg {
      width: vars.$hikari-icon-size-sm;
      height: vars.$hikari-icon-size-sm;
    }
  }
}

// ============================================
// Space-between layout (icon + text + suffix)
// ============================================

button.hi-button-space-between {
  // Icon and suffix on opposite edges, text in center
  justify-content: space-between;

  // Text should use line-height for baseline alignment
  > *:not(.hi-button-icon):not(.hi-button-suffix) {
    flex: 1;
    text-align: center;
    line-height: 1.5;
  }

  // Icon and suffix should be flex-centered (NOT line-height)
  .hi-button-icon,
  .hi-button-suffix {
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
  }
}

// Default gap for center layout (8px)
button.hi-button:not(.hi-button-space-between) {
  gap: 8px;
}

// ============================================
// Button width variants
// ============================================

.hi-button-width-auto {
  width: auto;
}

.hi-button-width-120 {
  width: 120px;
}

.hi-button-width-140 {
  width: 140px;
}

.hi-button-width-160 {
  width: 160px;
}

